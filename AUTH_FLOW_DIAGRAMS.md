# GeoWhisper Authentication System - Visual Flow Diagrams

## ðŸ“Š System Architecture Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CLIENT (Browser)                         â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Sign Up     â”‚  â”‚  Sign In     â”‚  â”‚  Google Sign-In      â”‚  â”‚
â”‚  â”‚  Form        â”‚  â”‚  Form        â”‚  â”‚  Button              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚         â”‚                  â”‚                      â”‚               â”‚
â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                            â”‚                                      â”‚
â”‚                            â–¼                                      â”‚
â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚                  â”‚  Firebase SDK   â”‚                             â”‚
â”‚                  â”‚  (Client Side)  â”‚                             â”‚
â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ HTTP/REST
                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   BACKEND (Spring Boot)                          â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              AuthController (REST API)                    â”‚   â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚  â”‚  â”‚ signup â”‚ â”‚ signin â”‚ â”‚ google â”‚ â”‚ profile endpointsâ”‚  â”‚   â”‚
â”‚  â”‚  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚         â”‚          â”‚          â”‚                 â”‚                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                  AuthService                               â”‚  â”‚
â”‚  â”‚  (Business Logic & Authentication Processing)             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚          â”‚          â”‚                 â”‚
          â”‚          â”‚          â”‚                 â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FIREBASE SERVICES                             â”‚
â”‚                                                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  Firebase Auth   â”‚   â”‚   Firestore DB   â”‚   â”‚  Firebase   â”‚ â”‚
â”‚  â”‚  (User Auth)     â”‚   â”‚  (User Profiles) â”‚   â”‚  Admin SDK  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸ” Email/Password Sign Up Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Client  â”‚                                         â”‚ Backend  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                                         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚                                                    â”‚
     â”‚  1. User fills sign-up form                       â”‚
     â”‚     (email, password, username)                   â”‚
     â”‚                                                    â”‚
     â”‚  2. POST /api/auth/signup                         â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>
     â”‚                                                    â”‚
     â”‚                                     3. Validate input
     â”‚                                        (email format,
     â”‚                                         password length)
     â”‚                                                    â”‚
     â”‚                                     4. Create user in
     â”‚                                        Firebase Auth
     â”‚                                                    â”‚
     â”‚                                     5. Generate custom
     â”‚                                        token
     â”‚                                                    â”‚
     â”‚                                     6. Create profile
     â”‚                                        in Firestore:
     â”‚                                        - username
     â”‚                                        - email
     â”‚                                        - totalPosts: 0
     â”‚                                        - totalReactions: 0
     â”‚                                        - zonesVisited: 0
     â”‚                                                    â”‚
     â”‚  7. Return auth response                          â”‚
     â”‚     (firebaseUid, token, userData)                â”‚
     <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚                                                    â”‚
     â”‚  8. Store token & firebaseUid                     â”‚
     â”‚     in localStorage                               â”‚
     â”‚                                                    â”‚
     â”‚  9. Redirect to dashboard                         â”‚
     â”‚                                                    â”‚
```

---

## ðŸ”‘ Email/Password Sign In Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Client  â”‚                                         â”‚ Backend  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                                         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚                                                    â”‚
     â”‚  1. User fills sign-in form                       â”‚
     â”‚     (email, password)                             â”‚
     â”‚                                                    â”‚
     â”‚  2. Authenticate with Firebase Client SDK         â”‚
     â”‚     signInWithEmailAndPassword()                  â”‚
     â”‚                                                    â”‚
     â”‚  3. POST /api/auth/signin                         â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>
     â”‚                                                    â”‚
     â”‚                                     4. Get user by email
     â”‚                                        from Firebase Auth
     â”‚                                                    â”‚
     â”‚                                     5. Get user profile
     â”‚                                        from Firestore
     â”‚                                                    â”‚
     â”‚                                     6. If profile missing,
     â”‚                                        create basic profile
     â”‚                                                    â”‚
     â”‚  7. Return user data                              â”‚
     â”‚     (firebaseUid, email, username, userData)      â”‚
     <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚                                                    â”‚
     â”‚  8. Get ID token from Firebase                    â”‚
     â”‚                                                    â”‚
     â”‚  9. Store token & data                            â”‚
     â”‚                                                    â”‚
     â”‚  10. Redirect to dashboard                        â”‚
     â”‚                                                    â”‚
```

---

## ðŸ”µ Google Sign-In Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Client  â”‚              â”‚  Google  â”‚              â”‚ Backend  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚                        â”‚                         â”‚
     â”‚  1. Click "Sign in     â”‚                         â”‚
     â”‚     with Google"       â”‚                         â”‚
     â”‚                        â”‚                         â”‚
     â”‚  2. signInWithPopup()  â”‚                         â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                         â”‚
     â”‚                        â”‚                         â”‚
     â”‚  3. Google auth popup  â”‚                         â”‚
     â”‚     opens              â”‚                         â”‚
     â”‚                        â”‚                         â”‚
     â”‚  4. User authenticates â”‚                         â”‚
     â”‚     with Google        â”‚                         â”‚
     â”‚                        â”‚                         â”‚
     â”‚  5. Return ID token    â”‚                         â”‚
     <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                         â”‚
     â”‚                        â”‚                         â”‚
     â”‚  6. POST /api/auth/google                       â”‚
     â”‚     { idToken, username }                       â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>
     â”‚                        â”‚                         â”‚
     â”‚                        â”‚          7. Verify ID token
     â”‚                        â”‚             with Firebase
     â”‚                        â”‚                         â”‚
     â”‚                        â”‚          8. Extract user info
     â”‚                        â”‚             (uid, email, name)
     â”‚                        â”‚                         â”‚
     â”‚                        â”‚          9. Check if profile
     â”‚                        â”‚             exists in Firestore
     â”‚                        â”‚                         â”‚
     â”‚                        â”‚          10. If new user:
     â”‚                        â”‚              - Create profile
     â”‚                        â”‚              - Set isNewUser: true
     â”‚                        â”‚                         â”‚
     â”‚                        â”‚          11. If existing:
     â”‚                        â”‚              - Get profile
     â”‚                        â”‚              - Set isNewUser: false
     â”‚                        â”‚                         â”‚
     â”‚  12. Return auth response                       â”‚
     â”‚      (firebaseUid, token, userData, isNewUser)  â”‚
     <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚                        â”‚                         â”‚
     â”‚  13. Store token & dataâ”‚                         â”‚
     â”‚                        â”‚                         â”‚
     â”‚  14. Redirect based on â”‚                         â”‚
     â”‚      isNewUser flag    â”‚                         â”‚
     â”‚                        â”‚                         â”‚
```

---

## ðŸ”’ Protected Request Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Client  â”‚                                         â”‚ Backend  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                                         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚                                                    â”‚
     â”‚  1. User makes protected request                  â”‚
     â”‚     (e.g., create post)                           â”‚
     â”‚                                                    â”‚
     â”‚  2. Get token from localStorage                   â”‚
     â”‚                                                    â”‚
     â”‚  3. POST /api/posts/create                        â”‚
     â”‚     Authorization: Bearer <token>                 â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>
     â”‚                                                    â”‚
     â”‚                                     4. Extract token
     â”‚                                        from header
     â”‚                                                    â”‚
     â”‚                                     5. Verify token
     â”‚                                        with Firebase
     â”‚                                                    â”‚
     â”‚                                     6. Get firebaseUid
     â”‚                                        from token
     â”‚                                                    â”‚
     â”‚                                     7. Process request
     â”‚                                        with authenticated
     â”‚                                        user context
     â”‚                                                    â”‚
     â”‚  8. Return response                               â”‚
     <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚                                                    â”‚
     â”‚  9. Display result                                â”‚
     â”‚                                                    â”‚
```

---

## ðŸ”„ Token Verification Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Client  â”‚                                         â”‚ Backend  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                                         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚                                                    â”‚
     â”‚  1. POST /api/auth/verify                         â”‚
     â”‚     Authorization: Bearer <token>                 â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>
     â”‚                                                    â”‚
     â”‚                                     2. Extract token
     â”‚                                        from Authorization
     â”‚                                        header
     â”‚                                                    â”‚
     â”‚                                     3. Verify with
     â”‚                                        Firebase Auth
     â”‚                                        verifyIdToken()
     â”‚                                                    â”‚
     â”‚                                     4. Get decoded token
     â”‚                                        with uid, email
     â”‚                                                    â”‚
     â”‚                                     5. Fetch user profile
     â”‚                                        from Firestore
     â”‚                                                    â”‚
     â”‚  6. Return auth response                          â”‚
     â”‚     (firebaseUid, email, username, userData)      â”‚
     <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚                                                    â”‚
     â”‚  7. Update user context                           â”‚
     â”‚                                                    â”‚
```

---

## ðŸ‘¤ Profile Management Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Client  â”‚                                         â”‚ Backend  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                                         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚                                                    â”‚
     â”‚  GET PROFILE                                      â”‚
     â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                     â”‚
     â”‚  GET /api/auth/profile/{firebaseUid}              â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>
     â”‚                                                    â”‚
     â”‚                                     Get document from
     â”‚                                     Firestore by UID
     â”‚                                                    â”‚
     â”‚  Return profile data                              â”‚
     <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚                                                    â”‚
     â”‚                                                    â”‚
     â”‚  UPDATE PROFILE                                   â”‚
     â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                   â”‚
     â”‚  PATCH /api/auth/profile/{firebaseUid}            â”‚
     â”‚  { username: "new_name" }                         â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>
     â”‚                                                    â”‚
     â”‚                                     Update Firestore
     â”‚                                     document
     â”‚                                     (protected fields
     â”‚                                      are ignored)
     â”‚                                                    â”‚
     â”‚  Return updated profile                           â”‚
     <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚                                                    â”‚
     â”‚                                                    â”‚
     â”‚  DELETE ACCOUNT                                   â”‚
     â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€                                   â”‚
     â”‚  DELETE /api/auth/profile/{firebaseUid}           â”‚
     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>
     â”‚                                                    â”‚
     â”‚                                     1. Delete from
     â”‚                                        Firebase Auth
     â”‚                                     2. Delete from
     â”‚                                        Firestore
     â”‚                                                    â”‚
     â”‚  Return success message                           â”‚
     <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
     â”‚                                                    â”‚
     â”‚  Clear local storage & redirect                   â”‚
     â”‚                                                    â”‚
```

---

## ðŸ“Š Data Flow Diagram

```
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚   Client App    â”‚
                        â”‚  (React/Next)   â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â”‚ HTTP Requests
                                 â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚ AuthController  â”‚
                        â”‚  (REST Layer)   â”‚
                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â”‚ Method Calls
                                 â”‚
                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
                        â”‚  AuthService    â”‚
                        â”‚ (Business Logic)â”‚
                        â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                             â”‚       â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚                                  â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚  Firebase Auth  â”‚              â”‚    Firestore     â”‚
       â”‚                 â”‚              â”‚                  â”‚
       â”‚ - User Creation â”‚              â”‚ - User Profiles  â”‚
       â”‚ - Authenticationâ”‚              â”‚ - User Data      â”‚
       â”‚ - Token Verify  â”‚              â”‚ - CRUD Ops       â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸ—„ï¸ Database Schema (Firestore)

```
Collection: users
â”œâ”€â”€ Document: {firebaseUid}
â”‚   â”œâ”€â”€ username: string
â”‚   â”œâ”€â”€ email: string
â”‚   â”œâ”€â”€ createdAt: timestamp
â”‚   â”œâ”€â”€ totalPosts: number
â”‚   â”œâ”€â”€ totalReactions: number
â”‚   â””â”€â”€ zonesVisited: number
â”‚
â”œâ”€â”€ Document: {firebaseUid}
â”‚   â””â”€â”€ ...
â””â”€â”€ ...
```

---

## ðŸŽ¯ API Response Structure

```
AuthResponse {
    firebaseUid: "abc123xyz"
    idToken: "eyJhbGciOi..."
    email: "user@example.com"
    username: "username"
    isNewUser: true/false
    userData: {
        username: "username"
        email: "user@example.com"
        totalPosts: 0
        totalReactions: 0
        zonesVisited: 0
        createdAt: "2025-10-26T10:30:00Z"
        firebaseUid: "abc123xyz"
    }
    message: "Success message"
}
```

---

## ðŸ” Security Layers

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              CLIENT VALIDATION                   â”‚
â”‚  - Email format                                  â”‚
â”‚  - Password strength (min 6 chars)               â”‚
â”‚  - Required fields                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          SPRING VALIDATION LAYER                 â”‚
â”‚  - @Valid annotations                            â”‚
â”‚  - @NotBlank, @Email                             â”‚
â”‚  - @Size constraints                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          FIREBASE AUTHENTICATION                 â”‚
â”‚  - User creation validation                      â”‚
â”‚  - Token generation & verification               â”‚
â”‚  - Email uniqueness check                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          BUSINESS LOGIC LAYER                    â”‚
â”‚  - Profile creation                              â”‚
â”‚  - Protected field filtering                     â”‚
â”‚  - Custom validation rules                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          FIRESTORE SECURITY                      â”‚
â”‚  - Document-level permissions                    â”‚
â”‚  - Data integrity                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸš€ Complete User Journey

```
1. FIRST TIME USER
   â”œâ”€> Visit app
   â”œâ”€> Click "Sign Up"
   â”œâ”€> Choose email or Google
   â”‚   â”‚
   â”‚   â”œâ”€> EMAIL PATH:
   â”‚   â”‚   â”œâ”€> Fill form (email, password, username)
   â”‚   â”‚   â”œâ”€> Submit â†’ Backend creates account
   â”‚   â”‚   â”œâ”€> Profile created in Firestore
   â”‚   â”‚   â””â”€> Redirect to dashboard
   â”‚   â”‚
   â”‚   â””â”€> GOOGLE PATH:
   â”‚       â”œâ”€> Click "Sign in with Google"
   â”‚       â”œâ”€> Google popup authentication
   â”‚       â”œâ”€> Backend receives token
   â”‚       â”œâ”€> Profile auto-created
   â”‚       â””â”€> Redirect to dashboard
   â”‚
   â””â”€> User is now authenticated

2. RETURNING USER
   â”œâ”€> Visit app
   â”œâ”€> Click "Sign In"
   â”œâ”€> Choose email or Google
   â”‚   â”‚
   â”‚   â”œâ”€> EMAIL PATH:
   â”‚   â”‚   â”œâ”€> Enter credentials
   â”‚   â”‚   â”œâ”€> Backend verifies & returns profile
   â”‚   â”‚   â””â”€> Redirect to dashboard
   â”‚   â”‚
   â”‚   â””â”€> GOOGLE PATH:
   â”‚       â”œâ”€> Click "Sign in with Google"
   â”‚       â”œâ”€> Auto-authentication
   â”‚       â”œâ”€> Backend returns existing profile
   â”‚       â””â”€> Redirect to dashboard
   â”‚
   â””â”€> User is authenticated

3. AUTHENTICATED USER
   â”œâ”€> Make requests with token
   â”œâ”€> Access protected routes
   â”œâ”€> Create posts
   â”œâ”€> View profile
   â”œâ”€> Update profile
   â””â”€> Sign out when done
```

---

## ðŸ“ˆ Success Metrics

```
âœ… Sign Up Success Rate
   â””â”€> Successful account creations / Total attempts

âœ… Sign In Success Rate
   â””â”€> Successful logins / Total attempts

âœ… Google Auth Usage
   â””â”€> Google sign-ins / Total sign-ins

âœ… Token Verification Rate
   â””â”€> Valid tokens / Total verifications

âœ… Profile Operations
   â””â”€> Successful updates / Total requests
```

---

This visual guide helps you understand how all the pieces work together! ðŸŽ¯
